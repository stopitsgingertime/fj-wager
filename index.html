<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>FJ Wagering Practice</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a6e 0%, #0d0d3d 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
            padding-top: env(safe-area-inset-top, 20px);
            padding-bottom: env(safe-area-inset-bottom, 20px);
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            padding-top: 50px;
        }

        h1 {
            text-align: center;
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #ffd700;
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            backdrop-filter: blur(10px);
        }

        .scoreboard {
            background: #0a0a4a;
            border: 3px solid #ffd700;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .scoreboard h2 {
            text-align: center;
            color: #ffd700;
            font-size: 1rem;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .score-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 215, 0, 0.3);
            font-size: 1.1rem;
        }

        .score-row:last-child {
            border-bottom: none;
        }

        .score-row.you {
            background: rgba(255, 215, 0, 0.2);
            margin: 0 -16px;
            padding: 10px 16px;
            border-radius: 8px;
        }

        .score-value {
            font-weight: bold;
            color: #4ade80;
        }

        .game-type {
            text-align: center;
            padding: 8px 16px;
            background: #ffd700;
            color: #0a0a4a;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin: 10px auto;
            width: 100%;
        }

        .position-select {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 16px;
        }

        .position-btn {
            padding: 14px;
            font-size: 1rem;
            border: 2px solid #ffd700;
            background: transparent;
            color: #fff;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .position-btn:hover, .position-btn:active {
            background: #ffd700;
            color: #0a0a4a;
        }

        .position-btn.full-width {
            grid-column: span 2;
        }

        .wager-section {
            text-align: center;
        }

        .wager-input {
            width: 100%;
            padding: 16px;
            font-size: 1.5rem;
            text-align: center;
            border: 3px solid #ffd700;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            margin: 10px 0;
            -webkit-appearance: none;
        }

        .wager-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .max-wager {
            color: #ffd700;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .submit-btn {
            width: 100%;
            padding: 16px;
            font-size: 1.2rem;
            background: #ffd700;
            color: #0a0a4a;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.1s;
            -webkit-tap-highlight-color: transparent;
        }

        .submit-btn:active {
            transform: scale(0.98);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .result {
            display: none;
        }

        .result.show {
            display: block;
        }

        .score-display {
            text-align: center;
            font-size: 3rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .score-100 { color: #4ade80; }
        .score-70 { color: #fbbf24; }
        .score-50 { color: #f87171; }

        .feedback {
            text-align: center;
            font-size: 1.1rem;
            margin-bottom: 16px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .optimal-info {
            background: rgba(0, 0, 0, 0.3);
            padding: 16px;
            border-radius: 10px;
            margin: 16px 0;
        }

        .optimal-info h3 {
            color: #ffd700;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .optimal-info p {
            margin: 8px 0;
            line-height: 1.5;
        }

        .explanation {
            font-size: 0.95rem;
            line-height: 1.6;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .next-btn {
            width: 100%;
            padding: 16px;
            font-size: 1.1rem;
            background: transparent;
            color: #ffd700;
            border: 2px solid #ffd700;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 10px;
            -webkit-tap-highlight-color: transparent;
        }

        .hidden {
            display: none !important;
        }

        .formula-hint {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 12px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            text-align: left;
        }

        .formula-hint code {
            background: rgba(255, 215, 0, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
            color: #ffd700;
        }

        /* Calculator styles */
        .calculator {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 16px;
            margin-top: 20px;
        }

        .calculator h3 {
            color: #ffd700;
            text-align: center;
            margin-bottom: 12px;
            font-size: 1rem;
        }

        .calc-display {
            width: 100%;
            padding: 14px;
            font-size: 1.5rem;
            text-align: right;
            border: 2px solid #ffd700;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            margin-bottom: 10px;
            font-family: monospace;
        }

        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .calc-btn {
            padding: 16px;
            font-size: 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.15);
            color: #fff;
            -webkit-tap-highlight-color: transparent;
            transition: background 0.1s;
        }

        .calc-btn:active,
        .calc-btn.pressed {
            background: rgba(255, 255, 255, 0.3);
        }

        .calc-btn.op {
            background: #ffd700;
            color: #0a0a4a;
            font-weight: bold;
        }

        .calc-btn.op:active,
        .calc-btn.op.pressed {
            background: #ffed4a;
        }

        .calc-btn.clear {
            background: #f87171;
            color: #fff;
        }

        .calc-btn.clear:active,
        .calc-btn.clear.pressed {
            background: #f59e9e;
        }

        .calc-btn.equals {
            background: #4ade80;
            color: #0a0a4a;
            font-weight: bold;
        }

        .calc-btn.equals:active,
        .calc-btn.equals.pressed {
            background: #86efac;
        }

        /* Floating notepad styles */
        .notepad-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #ffd700;
            color: #0a0a4a;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            -webkit-tap-highlight-color: transparent;
            transition: transform 0.2s;
        }

        .notepad-toggle:active {
            transform: scale(0.95);
        }

        .notepad-toggle.open {
            background: #f87171;
        }

        .notepad-container {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: calc(100% - 40px);
            max-width: 300px;
            background: rgba(10, 10, 74, 0.95);
            border: 2px solid #ffd700;
            border-radius: 12px;
            padding: 12px;
            z-index: 999;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            display: none;
            backdrop-filter: blur(10px);
        }

        .notepad-container.open {
            display: block;
        }

        .notepad-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .notepad-header h4 {
            color: #ffd700;
            font-size: 0.9rem;
            margin: 0;
        }

        .notepad-clear {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.75rem;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
        }

        .notepad-clear:active {
            background: rgba(255, 255, 255, 0.1);
        }

        .notepad-textarea {
            width: 100%;
            height: 150px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 8px;
            color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 0.9rem;
            padding: 10px;
            resize: none;
        }

        .notepad-textarea::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .notepad-textarea:focus {
            outline: none;
            border-color: #ffd700;
        }

        @media (max-width: 360px) {
            body {
                padding: 12px;
            }
            h1 {
                font-size: 1.3rem;
            }
            .score-row {
                font-size: 1rem;
            }
            .notepad-container {
                max-width: calc(100% - 40px);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>FJ Wagering Practice</h1>

        <!-- Position Selection -->
        <div id="position-section" class="card">
            <p style="text-align: center; margin-bottom: 16px;">Practice from which position?</p>
            <div class="position-select">
                <button class="position-btn" onclick="newGame(1)">1st Place</button>
                <button class="position-btn" onclick="newGame(2)">2nd Place</button>
                <button class="position-btn" onclick="newGame(3)">3rd Place</button>
                <button class="position-btn full-width" onclick="newGame(null)">Random</button>
            </div>
            <div class="formula-hint">
                <strong>Key Formula (1st place cover bet):</strong><br>
                <code>(2 &times; 2nd place) - Your score + $1</code>
            </div>
        </div>

        <!-- Game Section -->
        <div id="game-section" class="hidden">
            <div class="scoreboard">
                <h2>Final Jeopardy</h2>
                <div class="score-row" id="row-1">
                    <span>1st Place</span>
                    <span class="score-value" id="score-1">$0</span>
                </div>
                <div class="score-row" id="row-2">
                    <span>2nd Place</span>
                    <span class="score-value" id="score-2">$0</span>
                </div>
                <div class="score-row" id="row-3">
                    <span>3rd Place</span>
                    <span class="score-value" id="score-3">$0</span>
                </div>
            </div>

            <div style="text-align: center;">
                <span class="game-type" id="game-type">Loading...</span>
            </div>

            <div id="wager-section" class="card wager-section">
                <p class="max-wager">Your max wager: <strong id="max-wager">$0</strong></p>
                <input type="number"
                       id="wager-input"
                       class="wager-input"
                       placeholder="Enter wager"
                       inputmode="numeric"
                       min="0">
                <button class="submit-btn" onclick="submitWager()">Lock In Wager</button>
            </div>

            <div id="result-section" class="card result">
                <div class="score-display" id="result-score">0/100</div>
                <div class="feedback" id="result-feedback"></div>

                <div class="optimal-info">
                    <h3>Optimal Strategy</h3>
                    <p><strong>Your wager:</strong> <span id="your-wager">$0</span></p>
                    <p><strong>Optimal range:</strong> <span id="optimal-range">$0 - $0</span></p>
                    <p><strong>Recommended:</strong> <span id="recommended">$0</span></p>
                    <div class="explanation" id="explanation"></div>
                </div>

                <button class="next-btn" onclick="showPositionSelect()">Next Scenario</button>
            </div>
        </div>

        <!-- Calculator -->
        <div class="calculator">
            <h3>Calculator</h3>
            <input type="text" id="calc-display" class="calc-display" readonly value="0">
            <div class="calc-buttons">
                <button class="calc-btn clear" onclick="calcClear()">C</button>
                <button class="calc-btn" onclick="calcBackspace()">‚å´</button>
                <button class="calc-btn op" onclick="calcOp('/')">&divide;</button>
                <button class="calc-btn op" onclick="calcOp('*')">&times;</button>

                <button class="calc-btn" onclick="calcDigit('7')">7</button>
                <button class="calc-btn" onclick="calcDigit('8')">8</button>
                <button class="calc-btn" onclick="calcDigit('9')">9</button>
                <button class="calc-btn op" onclick="calcOp('-')">‚àí</button>

                <button class="calc-btn" onclick="calcDigit('4')">4</button>
                <button class="calc-btn" onclick="calcDigit('5')">5</button>
                <button class="calc-btn" onclick="calcDigit('6')">6</button>
                <button class="calc-btn op" onclick="calcOp('+')">+</button>

                <button class="calc-btn" onclick="calcDigit('1')">1</button>
                <button class="calc-btn" onclick="calcDigit('2')">2</button>
                <button class="calc-btn" onclick="calcDigit('3')">3</button>
                <button class="calc-btn equals" onclick="calcEquals()">=</button>

                <button class="calc-btn" onclick="calcDigit('0')">0</button>
                <button class="calc-btn" onclick="calcDigit('00')">00</button>
                <button class="calc-btn op" onclick="calcPlus1()">+1</button>
                <button class="calc-btn op" onclick="calcTimes2()">√ó2</button>
            </div>
        </div>
    </div>

    <!-- Floating Notepad -->
    <div id="notepad-container" class="notepad-container">
        <div class="notepad-header">
            <h4>Scratch Pad</h4>
            <button class="notepad-clear" onclick="clearNotepad()">Clear</button>
        </div>
        <textarea id="notepad" class="notepad-textarea" placeholder="Jot down wager calculations..."></textarea>
    </div>
    <button id="notepad-toggle" class="notepad-toggle" onclick="toggleNotepad()">üìù</button>

    <script>
        // Wagering logic - all client-side
        let currentScenario = null;

        function formatMoney(amount) {
            return '$' + amount.toLocaleString();
        }

        function classifyGame(leader, second) {
            if (second === 0 || leader === 0) return "Runaway";
            const ratio = second / leader;
            if (ratio < 0.5) return "Lock";
            if (ratio === 0.5) return "Lock-Tie";
            if (ratio < 0.67) return "Crush";
            if (ratio < 0.75) return "Two-Thirds";
            return "Three-Quarters";
        }

        function getOptimalWagerFirst(scores) {
            const leader = scores[1];
            const second = scores[2];
            const gameType = classifyGame(leader, second);
            const coverBet = Math.max(0, (2 * second) - leader + 1);

            if (gameType === "Lock") {
                const maxSafe = leader - (2 * second) - 1;
                return {
                    min: 0,
                    max: Math.max(0, maxSafe),
                    recommended: 0,
                    explanation: `Lock game! Second place can't catch you even if you're wrong and they're right. Bet $0-${formatMoney(Math.max(0, maxSafe))} to stay safe.`
                };
            } else if (gameType === "Lock-Tie") {
                return {
                    min: 0,
                    max: 1,
                    recommended: 0,
                    explanation: "Lock-Tie game. Bet $0 (if you'd lose a tiebreaker) or $1 (if you'd win). Most bet $0 to guarantee at least a tie."
                };
            } else {
                return {
                    min: coverBet,
                    max: leader,
                    recommended: coverBet,
                    explanation: `Cover bet: Wager ${formatMoney(coverBet)} to guarantee a win if you're right. Formula: (2 √ó ${formatMoney(second)}) - ${formatMoney(leader)} + $1 = ${formatMoney(coverBet)}`
                };
            }
        }

        function getOptimalWagerSecond(scores) {
            const leader = scores[1];
            const second = scores[2];
            const third = scores[3];

            // MINIMUM 1: To beat leader's current score (if they bet $0 or small)
            const minToBeatLeader = leader - second + 1;

            // MINIMUM 2: Cover third place
            const thirdCover = third > 0 ? Math.max(0, (2 * third) - second + 1) : 0;

            // Your minimum wager is the larger of these
            const minWager = Math.max(minToBeatLeader, thirdCover);

            // What will leader bet? (Assume cover bet)
            const leaderCover = Math.max(0, (2 * second) - leader + 1);
            const leaderIfWrong = leader - leaderCover;

            // Can you stay above leader's wrong score if you're also wrong?
            // If leader_if_wrong >= second, there's no safe bet
            const maxStaySafe = leaderIfWrong < second ? second - leaderIfWrong - 1 : -1;

            // If you can't even make the minimum bet, bet everything
            if (minWager > second) {
                return {
                    min: second,
                    max: second,
                    recommended: second,
                    explanation: `You can't catch the leader (need ${formatMoney(minWager)}, you have ${formatMoney(second)}). Bet everything and hope for a miracle.`
                };
            }

            // Can you both meet the minimum AND stay safe if wrong?
            if (maxStaySafe >= minWager) {
                return {
                    min: minWager,
                    max: maxStaySafe,
                    recommended: minWager,
                    explanation: `Bet at least ${formatMoney(minWager)} to beat leader if they stumble. If leader bets ${formatMoney(leaderCover)} and misses, they'll have ${formatMoney(leaderIfWrong)}. Stay below ${formatMoney(maxStaySafe + 1)} to beat them if you're both wrong.`
                };
            } else {
                return {
                    min: minWager,
                    max: second,
                    recommended: minWager,
                    explanation: `Bet ${formatMoney(minWager)} to beat leader's current score. If wrong, you can't stay above leader's wrong score (${formatMoney(leaderIfWrong)}), so just bet to win.`
                };
            }
        }

        function getOptimalWagerThird(scores) {
            const leader = scores[1];
            const second = scores[2];
            const third = scores[3];

            const inContention = (third + second > leader) && (third > second * 0.5);

            if (!inContention) {
                return {
                    min: 0,
                    max: third,
                    recommended: third,
                    explanation: `You're not mathematically in contention. Bet it all and hope for a miracle, or bet small to preserve 3rd place money.`
                };
            }

            const leaderCover = Math.max(0, (2 * second) - leader + 1);
            const leaderIfWrong = leader - leaderCover;
            const secondCoverThird = Math.max(0, (2 * third) - second + 1);
            const secondIfWrong = second - secondCoverThird;
            const minToBeatBoth = Math.max(leaderIfWrong, secondIfWrong) - third + 1;

            if (minToBeatBoth > 0 && minToBeatBoth <= third) {
                return {
                    min: Math.max(0, minToBeatBoth),
                    max: third,
                    recommended: Math.max(0, minToBeatBoth),
                    explanation: `You're in contention! If both miss: Leader ${formatMoney(leaderIfWrong)}, Second ${formatMoney(secondIfWrong)}. Bet at least ${formatMoney(Math.max(0, minToBeatBoth))} to beat both.`
                };
            } else {
                return {
                    min: 0,
                    max: third,
                    recommended: third,
                    explanation: `Tough spot. Need both to miss. Consider betting everything for the best chance.`
                };
            }
        }

        function getOptimalWager(scenario) {
            if (scenario.position === 1) return getOptimalWagerFirst(scenario.scores);
            if (scenario.position === 2) return getOptimalWagerSecond(scenario.scores);
            return getOptimalWagerThird(scenario.scores);
        }

        function generateScenario(position) {
            const gameTypes = ["Lock", "Crush", "Two-Thirds", "Three-Quarters", "Close"];
            const gameType = gameTypes[Math.floor(Math.random() * gameTypes.length)];

            let leader = Math.floor(Math.random() * (28000 - 12000) + 12000);
            leader = Math.floor(leader / 100) * 100;

            let second;
            if (gameType === "Lock") {
                second = Math.floor(Math.random() * (leader * 0.48 - leader * 0.25) + leader * 0.25);
            } else if (gameType === "Crush") {
                second = Math.floor(Math.random() * (leader * 0.65 - leader * 0.52) + leader * 0.52);
            } else if (gameType === "Two-Thirds") {
                second = Math.floor(Math.random() * (leader * 0.74 - leader * 0.67) + leader * 0.67);
            } else if (gameType === "Three-Quarters") {
                second = Math.floor(Math.random() * (leader * 0.90 - leader * 0.76) + leader * 0.76);
            } else {
                second = Math.floor(Math.random() * (leader * 0.99 - leader * 0.85) + leader * 0.85);
            }
            second = Math.floor(second / 100) * 100;

            let third = Math.floor(Math.random() * (second * 0.9 - second * 0.3) + second * 0.3);
            third = Math.floor(third / 100) * 100;

            if (position === null) {
                position = Math.floor(Math.random() * 3) + 1;
            }

            const scores = { 1: leader, 2: second, 3: third };

            return {
                scores: scores,
                position: position,
                yourScore: scores[position],
                gameType: classifyGame(leader, second)
            };
        }

        function newGame(position) {
            document.getElementById('position-section').classList.add('hidden');
            document.getElementById('game-section').classList.remove('hidden');
            document.getElementById('wager-section').classList.remove('hidden');
            document.getElementById('result-section').classList.remove('show');
            document.getElementById('wager-input').value = '';

            currentScenario = generateScenario(position);

            // Update scoreboard
            document.getElementById('score-1').textContent = formatMoney(currentScenario.scores[1]);
            document.getElementById('score-2').textContent = formatMoney(currentScenario.scores[2]);
            document.getElementById('score-3').textContent = formatMoney(currentScenario.scores[3]);

            // Highlight your position
            document.querySelectorAll('.score-row').forEach(row => row.classList.remove('you'));
            document.getElementById('row-' + currentScenario.position).classList.add('you');

            // Update game type and max wager
            document.getElementById('game-type').textContent = currentScenario.gameType + ' Game';
            document.getElementById('max-wager').textContent = formatMoney(currentScenario.yourScore);
            document.getElementById('wager-input').max = currentScenario.yourScore;

            // Focus the input
            setTimeout(() => document.getElementById('wager-input').focus(), 100);
        }

        function submitWager() {
            const wagerInput = document.getElementById('wager-input');
            const wager = parseInt(wagerInput.value) || 0;

            if (wager < 0 || wager > currentScenario.yourScore) {
                alert('Wager must be between $0 and ' + formatMoney(currentScenario.yourScore));
                return;
            }

            const optimal = getOptimalWager(currentScenario);

            // Calculate score
            let score, feedback;
            if (optimal.min <= wager && wager <= optimal.max) {
                score = 100;
                feedback = "Excellent! Your wager is within the optimal range.";
            } else if (wager === optimal.recommended) {
                score = 100;
                feedback = "Perfect! You chose the recommended wager.";
            } else {
                if (currentScenario.position === 1) {
                    if (wager > optimal.max) {
                        score = 50;
                        feedback = "Too aggressive! You risked more than necessary.";
                    } else {
                        score = 70;
                        feedback = "Too conservative. You might not cover second place.";
                    }
                } else {
                    if (wager > optimal.max) {
                        score = 60;
                        feedback = "Risky! You might drop below a key threshold if wrong.";
                    } else {
                        score = 70;
                        feedback = "A bit conservative, but defensible.";
                    }
                }
            }

            // Show results
            document.getElementById('wager-section').classList.add('hidden');
            document.getElementById('result-section').classList.add('show');

            // Update result display
            const scoreDisplay = document.getElementById('result-score');
            scoreDisplay.textContent = score + '/100';
            scoreDisplay.className = 'score-display';
            if (score >= 100) scoreDisplay.classList.add('score-100');
            else if (score >= 70) scoreDisplay.classList.add('score-70');
            else scoreDisplay.classList.add('score-50');

            document.getElementById('result-feedback').textContent = feedback;
            document.getElementById('your-wager').textContent = formatMoney(wager);
            document.getElementById('optimal-range').textContent =
                formatMoney(optimal.min) + ' - ' + formatMoney(optimal.max);
            document.getElementById('recommended').textContent = formatMoney(optimal.recommended);
            document.getElementById('explanation').textContent = optimal.explanation;
        }

        function showPositionSelect() {
            document.getElementById('game-section').classList.add('hidden');
            document.getElementById('position-section').classList.remove('hidden');
            clearNotepad();
        }

        // Notepad functions
        function toggleNotepad() {
            const container = document.getElementById('notepad-container');
            const toggle = document.getElementById('notepad-toggle');
            container.classList.toggle('open');
            toggle.classList.toggle('open');
            toggle.textContent = container.classList.contains('open') ? '‚úï' : 'üìù';
        }

        function clearNotepad() {
            document.getElementById('notepad').value = '';
        }

        // Allow Enter key to submit
        document.getElementById('wager-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                submitWager();
            }
        });

        // Calculator functions
        let calcValue = '0';
        let calcPrevValue = null;
        let calcOperator = null;
        let calcNewNumber = true;

        function updateCalcDisplay() {
            const display = document.getElementById('calc-display');
            display.value = Number(calcValue).toLocaleString();
        }

        function calcDigit(d) {
            if (calcNewNumber) {
                calcValue = d;
                calcNewNumber = false;
            } else {
                if (calcValue.length < 12) {
                    calcValue += d;
                }
            }
            updateCalcDisplay();
        }

        function calcOp(op) {
            if (calcPrevValue !== null && !calcNewNumber) {
                calcEquals();
            }
            calcPrevValue = calcValue;
            calcOperator = op;
            calcNewNumber = true;
        }

        function calcPlus1() {
            calcValue = String(parseFloat(calcValue) + 1);
            updateCalcDisplay();
        }

        function calcTimes2() {
            calcValue = String(parseFloat(calcValue) * 2);
            updateCalcDisplay();
        }

        function calcEquals() {
            if (calcPrevValue === null || calcOperator === null) return;

            const prev = parseFloat(calcPrevValue);
            const curr = parseFloat(calcValue);
            let result;

            switch (calcOperator) {
                case '+': result = prev + curr; break;
                case '-': result = prev - curr; break;
                case '*': result = prev * curr; break;
                case '/': result = curr !== 0 ? prev / curr : 0; break;
            }

            calcValue = String(Math.round(result));
            calcPrevValue = null;
            calcOperator = null;
            calcNewNumber = true;
            updateCalcDisplay();
        }

        function calcClear() {
            calcValue = '0';
            calcPrevValue = null;
            calcOperator = null;
            calcNewNumber = true;
            updateCalcDisplay();
        }

        function calcBackspace() {
            if (calcValue.length > 1) {
                calcValue = calcValue.slice(0, -1);
            } else {
                calcValue = '0';
                calcNewNumber = true;
            }
            updateCalcDisplay();
        }

        // Add touch feedback for mobile
        document.querySelectorAll('.calc-btn').forEach(btn => {
            btn.addEventListener('touchstart', function(e) {
                this.classList.add('pressed');
            }, { passive: true });

            btn.addEventListener('touchend', function(e) {
                this.classList.remove('pressed');
            }, { passive: true });

            btn.addEventListener('touchcancel', function(e) {
                this.classList.remove('pressed');
            }, { passive: true });
        });
    </script>
</body>
</html>
